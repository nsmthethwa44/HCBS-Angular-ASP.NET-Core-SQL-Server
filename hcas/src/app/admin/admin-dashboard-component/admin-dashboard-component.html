<div class="overview">
    <div class="content">

        <div class="title">
            <h3>Dashboard</h3>

           <span class="date"><i class="fa-regular fa-calendar-days"></i>{{ getDate() | date: 'MMM d, y, h:m a' }}</span>
        </div>

      <app-stats-component></app-stats-component>

      <div class="chart-box">
         <div class="box">
            <div class="chart">
                <h3>Top Doctors Summary</h3>
                <div class="box-chart">
                    <ngx-charts-bar-vertical
                        [results]="topDoctorsChart"
                        [xAxis]="true"
                        [yAxis]="true"
                        [legend]="false"
                        [view]="view"
                        [showXAxisLabel]="true"
                        [showYAxisLabel]="true"
                        xAxisLabel="Doctors"
                        yAxisLabel="Appointments"
                        [customColors]="customColors">
                    </ngx-charts-bar-vertical>
                </div>
            </div>
        </div>
          <div class="box">
            <div class="chart">
                <h3>Top Patient & Doctors Summary</h3>
                <div class="box-chart">
                    <ngx-charts-bar-horizontal
                        [results]="userSummaryChart"
                        [xAxis]="true"
                        [yAxis]="true"
                        [legend]="false"
                        [view]="view"
                        [showXAxisLabel]="true"
                        [showYAxisLabel]="true"
                        xAxisLabel="Count"
                        yAxisLabel="User Role"
                        [customColors]="customColors">
                    </ngx-charts-bar-horizontal>
                </div>
            

            </div>
        </div>
      </div>

        <div class="content-box">

            <div class="left">
                <div class="box t-b">
                    <div class="table-container">
                           <h3>Recent Appointments <a  routerLink="/admin/appointments" class="view">View All</a></h3>
                        <div class="table-content">
                             @if(appointments && appointments.length > 0){
                              <table>
                                <thead>
                                    <tr>
                                        <th>Photo</th>
                                        <th>Patient</th>
                                        <th>Image</th>
                                        <th>Doctor</th>
                                        <th>Date</th>
                                        <th>Time</th>
                                        <th>Gender</th>
                                        <th>Status</th>
                                        <th>Phone</th>
                                        <th>Action</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr *ngFor="let appointment of appointments.slice(0, 3)">
                                        <td><img src="assets\img\male_user_40px.png" alt="Patient" class="image"></td>
                                        <td>{{ appointment.patientName }}</td>
                                        <td><img [src]="'https://localhost:7197' + appointment.doctorImage" alt="Doctor image" class="image"></td>
                                        <td>Dr.{{ appointment.doctorName }}</td>
                                        <td>{{ appointment.appointmentDate | date: 'MMM d, y' }}</td>
                                        <td>{{ appointment.appointmentDate | date: 'h:mm a' }}</td>
                                          <td class="null">NULL</td>
                                        <td>
                                            <span class="status" [ngClass]="getStatusClass(appointment.status)">
                                            {{ getStatusText(appointment.status) }}
                                            </span>
                                        </td>
                                          <td class="null">NULL</td>
                                        <td>
                                             <div class="buttons">
                                                <i class="fa-solid fa-eye"></i>
                                                <i
                                                    *ngIf="appointment.status === 0"
                                                    class="fa-solid  fa-circle-check"
                                                    (click)="getApproveAppointment(appointment.id)"
                                                ></i>
                                                <span *ngIf="appointment.status !== 0"><i class="fa-solid fa-minus"></i></span>
                                                <i class="fa-solid fa-trash-can"></i>
                                                </div>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                             }@else {
                                 <p>No appointments booked.</p>
                             }
                         
                        </div>
                    </div>
                </div>
                <div class="box t-b">
                    <div class="table-container">
                           <h3>Active Patients <a routerLink="/admin/users" class="view">View All</a></h3>
                        <div class="table-content">
                            @if(patients && patients.length > 0){
                                <table>
                                <thead>
                                    <tr>
                                        <th>Photo</th>
                                        <th>Name</th>
                                        <th>Gender</th>
                                        <th>Email</th>
                                        <th>Date Of Birth</th>
                                        <th>Address</th>
                                        <th>Phone Number</th>
                                        <th>Action</th>
                                    </tr>
                                </thead>
                                <tbody>
                             @for (item of patients.slice(0, 4); track $index) {
                                <tr>
                                    <td><img src="assets/img/male_user_40px.png" alt="Patient" class="image"></td>
                                    <td>{{item.fullName}}</td>
                                    <td class="null">NULL</td>
                                    <td>{{item.email}}</td>
                                    <td class="null">NULL</td>
                                    <td class="null">NULL</td>
                                    <td class="null">NULL</td>
                                    <td>
                                    <div class="buttons">
                                        <i class="fa-solid fa-eye"></i>
                                        <i class="fa-solid fa-pen"></i>
                                        <i class="fa-solid fa-trash-can" (click)="deletePatient(item.id)"></i>
                                    </div>
                                    </td>
                                </tr>
                                }
                                </tbody>
                            </table>
                            }@else {
                                <p>Patients not found.</p>
                            }
                        </div>
                    </div>
                </div>
            </div>

            <div class="right">
                 <app-panel-list-doctors></app-panel-list-doctors>
            </div>

        </div>
    </div>
</div>

